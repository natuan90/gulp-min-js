!function(t,n){skygate.util.format;skygate.air=t.skygate.air||{},skygate.air.util=function(t){var n=t.countrySuggestionList,e=t.citySuggestionList,r=t.relationship,i=r.countries,o=r.cities;function u(t,n){function e(t,n,e){return _.chain(t).filter(function(t){return _.any([t.threeLetter||""],n)||_.any(t.candidateWords,n)}).map(e).value()}return{startWithWordSearch:function(r){return e(t,function(t){return 0===t.indexOf(r)},n)},includeWordSearch:function(r){return e(t,function(t){return t.indexOf(r)>0},n)}}}var a=u(n,function(t){return t.countryCode}),c=u(e,function(t){return t.threeLetter}),s=function(t,n){function e(n){var e=t[n];return e?e.cities:[]}function r(t){var e=n[t];if(e)return{name:e.name,threeLetter:t,katakana:e.katakana,countryName:e.countryName,domesticThreeLetter:e.domesticThreeLetter,children:_.map(e.childCityCodes,r)}}return{getCityByCountryCodeList:function(t){var n=[];return _.each(t,function(t){Array.prototype.push.call(n,e(t))}),n},getCityByCountryCode:e,getCitySuggestionList:function(t){return _.map(t,r)},getCitySuggestion:r}}(i,o);function y(t){var n,e=a.startWithWordSearch(t),r=_.flatten(s.getCityByCountryCodeList(e));return/^[A-Z]{3}$/g.test(n=t)&&o[n]&&(r=_.union(r,[t])),_.union(r,c.startWithWordSearch(t))}return{search:function(t,n,e,r){var i=y(t),o=_.filter(i,function(t){var n=this.getCityCodeByDomesticOrAbroad(t,e);if(n)return n},this),u=_.sortBy(s.getCitySuggestionList(_.difference(o,r)),"katakana"),f=u.length;if(f>=n)return u.slice(0,n);var g=_.difference(function(t){var n=a.includeWordSearch(t),e=_.flatten(s.getCityByCountryCodeList(n));return _.union(e,c.includeWordSearch(t))}(t),i,r),d=_.filter(g,function(t){var n=this.getCityCodeByDomesticOrAbroad(t,e);if(n)return n},this),C=_.sortBy(s.getCitySuggestionList(d),"katakana").slice(0,n-f);return _.union(u,C)},isJapanCity:function(t){return o[t]?"JP"===o[t].countryCode:null},getCityInfo:function(t){return s.getCitySuggestion(t)},getCityCodeByDomesticOrAbroad:function(t,n){if(_.isBoolean(n)){var e=this.isJapanCity(t);return _.isBoolean(e)&&n===e?t:void 0}return t}}}(t.suggestSupportingData||{})}(window,jQuery);