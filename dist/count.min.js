!function(t,o){var e=o(document),n=Backbone.View.extend({toApiResponseType:{saved_search:"saved_search",search:"search_history"},initialize:function(t){_.bindAll(this,"getCount","renderCount","transmitCount"),this.model=new airlink.model.common.bookmarks.BookmarksCount(null,{service:t.target}),e.on("bookmarks:updateCount",this.getCount),e.on("bookmarks:updateCountCompleted bookmarks:updateCountFailed",this.renderCount),e.on("bookmarks:requireCount",this.transmitCount),t.updateCount&&e.trigger("bookmarks:updateCount")},getCount:function(t,o){this.model.getCount(o&&o.types)},renderCount:function(t,e){if(e){var n=o(".targetBookmarksCount, .targetBookmarksToggle");if(n.length){var a=this;n.each(function(){var t=o(this),n=_.map(t.data("type").split(","),function(t){return a.toApiResponseType[o.trim(t)]}),i=_.values(_.pick(e,n));if(!_.isEmpty(i)){var s=_.reduce(i,function(t,o){return t+o},0);if(t.hasClass("targetBookmarksCount")&&t.text(s),t.hasClass("targetBookmarksToggle")){var r=t.data("activeClass");t.toggleClass(r,s>0)}}})}}},transmitCount:function(t,o){if(_.isFunction(o)){var e={},n=_.invert(this.toApiResponseType);_.each(this.model.toJSON(),function(t,o){e[n[o]]=t}),o(e)}}});skygate.util.namespace("airlink.view.air.bookmarks").BookmarksCountView=n}(window,jQuery);